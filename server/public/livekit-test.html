<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LiveKit Connection Test</title>
  <script src="https://unpkg.com/livekit-client/dist/livekit-client.min.js"></script>
  <style>
    body { background: #181818; color: #fff; font-family: sans-serif; padding: 2em; }
    #log { background: #222; color: #bada55; padding: 1em; border-radius: 8px; font-size: 1em; max-width: 700px; margin: 2em auto; white-space: pre-wrap; }
    input, button { font-size: 1em; margin: 0.5em 0; }
  </style>
</head>
<body>
  <h1>LiveKit Minimal Connection Test</h1>
  <form id="test-form">
    <label>LiveKit WS URL: <input id="wsUrl" type="text" style="width: 400px;" value="URL" required></label><br>
    <label>Token: <input id="token" type="text" style="width: 400px;" required></label><br>
    <button type="submit">Connect</button>
  </form>
  <div id="log"></div>
  <script>
    const logDiv = document.getElementById('log');
    function log(msg) {
      logDiv.textContent += msg + '\n';
      logDiv.scrollTop = logDiv.scrollHeight;
      //console.log(msg);
    }
    document.getElementById('test-form').onsubmit = async (e) => {
      e.preventDefault();
      logDiv.textContent = '';
      const wsUrl = document.getElementById('wsUrl').value.trim();
      const token = document.getElementById('token').value.trim();
      if (!wsUrl || !token) {
        log('Missing wsUrl or token');
        return;
      }
      log('[Test] Token: ' + token);
      log('[Test] Creating LiveKit Room...');
      const room = new window.LiveKit.Room();
      room.on('connected', () => log('[Test] ‚úÖ Connected to room'));
      room.on('disconnected', () => log('[Test] üîå Disconnected from room'));
      room.on('connectionStateChanged', state => log('[Test] üõ∞Ô∏è State changed: ' + state));
      room.on('trackSubscribed', (track, publication, participant) => {
        log('[Test] Track subscribed: ' + track.kind + ' from ' + participant.identity);
      });
      try {
        log('[Test] Connecting to ' + wsUrl + ' ...');
        await room.connect(wsUrl, token);
        log('[Test] üéâ Connected successfully!');
      } catch (err) {
        log('[Test] ‚ùå Connection error: ' + err);
      }
    };
  </script>
</body>
</html>
